<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Tạo phiếu xuất</title>
<link rel="stylesheet" th:href="@{/css/warehouse.css}">
</head>
<body>
	<div th:replace="~{fragments/warehouse-header :: header}"></div>
	<div class="container">
		<h1>Tạo phiếu xuất kho</h1>
		<form th:action="@{/warehouse/outbound/create}" th:object="${receipt}"
			method="post" class="form">
			<div class="form-row">
				<div class="form-group">
					<label>Mã phiếu *</label> <input type="text"
						th:field="*{receiptCode}" required>
				</div>
				<div class="form-group">
					<label>Đơn hàng *</label> <select th:field="*{order.id}" required>
						<option value="">-- Chọn đơn --</option>
						<option th:each="order : ${orders}" th:value="${order.id}"
							th:text="${order.orderCode}"></option>
					</select>
				</div>
			</div>
			<div class="form-group">
				<label>Shipper *</label> <select th:field="*{shipper.id}" required>
					<option value="">-- Chọn Shipper --</option>
					<option th:each="shipper : ${shippers}" th:value="${shipper.id}"
						th:text="${shipper.name}"></option>
				</select>
			</div>
			<div class="form-group">
				<label>Ghi chú</label>
				<textarea th:field="*{notes}" rows="2"></textarea>
			</div>

			<div id="package-list">
				<h3>Danh sách kiện hàng</h3>
				<div class="package-item">
					<select name="packageIds" required>
						<option value="">-- Chọn kiện --</option>
						<option th:each="inv : ${availableInventory}"
							th:value="${inv.packageItem.id}"
							th:text="${inv.packageItem.packageCode} + ' (Còn: ' + ${inv.remainingQuantity} + ')'"></option>
					</select> <input type="number" name="quantities" placeholder="Số lượng"
						min="1" required>
				</div>
			</div>
			<button type="button" onclick="addPackage()"
				class="btn-secondary mb-3">+ Thêm kiện</button>

			<div class="form-actions">
				<button type="submit" class="btn-primary">Tạo phiếu</button>
				<a th:href="@{/warehouse/outbound}" class="btn-secondary">Hủy</a>
			</div>
		</form>
	</div>
	<script>
        function addPackage() {
            const list = document.getElementById('package-list');
            const item = document.querySelector('.package-item').cloneNode(true);
            list.appendChild(item);
        }
    </script>
</body>
</html>