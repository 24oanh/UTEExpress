<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Chi tiết đơn hàng</title>
<link rel="stylesheet" th:href="@{/css/shipper.css}">
</head>
<body>
	<div th:replace="~{fragments/shipper-header :: header}"></div>
	<div class="container">
		<div class="page-header">
			<h1>Chi tiết đơn hàng</h1>
			<a th:href="@{/shipper/orders}" class="btn-secondary">Quay lại</a>
		</div>

		<div class="detail-grid">
			<div class="detail-card">
				<h3>Thông tin đơn</h3>
				<p>
					<strong>Mã đơn:</strong> <span th:text="${order.orderCode}"></span>
				</p>
				<p>
					<strong>Trạng thái:</strong> <span
						th:class="'badge badge-' + ${order.status}"
						th:text="${order.status}"></span>
				</p>
				<p>
					<strong>Phí vận chuyển:</strong> <span
						th:text="${#numbers.formatDecimal(order.shipmentFee, 0, 'COMMA', 0, 'POINT')} + ' đ'"></span>
				</p>
				<p>
					<strong>Ghi chú:</strong> <span th:text="${order.notes ?: '-'}"></span>
				</p>
			</div>

			<div class="detail-card">
				<h3>Người gửi</h3>
				<p>
					<strong>Tên:</strong> <span th:text="${order.senderName}"></span>
				</p>
				<p>
					<strong>SĐT:</strong> <a th:href="'tel:' + ${order.senderPhone}"
						th:text="${order.senderPhone}"></a>
				</p>
				<p>
					<strong>Địa chỉ:</strong> <span th:text="${order.senderAddress}"></span>
				</p>
			</div>

			<div class="detail-card">
				<h3>Người nhận</h3>
				<p>
					<strong>Tên:</strong> <span th:text="${order.recipientName}"></span>
				</p>
				<p>
					<strong>SĐT:</strong> <a th:href="'tel:' + ${order.recipientPhone}"
						th:text="${order.recipientPhone}"></a>
				</p>
				<p>
					<strong>Địa chỉ:</strong> <span th:text="${order.recipientAddress}"></span>
				</p>
				<button onclick="openMap()" class="btn-primary mt-2">Mở bản
					đồ</button>
			</div>
		</div>

		<div class="section">
			<h3>Danh sách kiện hàng</h3>
			<table>
				<thead>
					<tr>
						<th>Mã kiện</th>
						<th>Mô tả</th>
						<th>Trọng lượng</th>
						<th>Kích thước</th>
						<th>Trạng thái</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="pkg : ${packages}">
						<td th:text="${pkg.packageCode}"></td>
						<td th:text="${pkg.description}"></td>
						<td th:text="${pkg.weight} + ' kg'"></td>
						<td
							th:text="${pkg.length} + 'x' + ${pkg.width} + 'x' + ${pkg.height} + ' cm'"></td>
						<td><span th:class="'badge badge-' + ${pkg.status}"
							th:text="${pkg.status}"></span></td>
					</tr>
				</tbody>
			</table>
		</div>

		<div class="section" th:if="${shipment != null}">
			<h3>Thông tin giao hàng</h3>
			<p>
				<strong>Mã giao hàng:</strong> <span
					th:text="${shipment.shipmentCode}"></span>
			</p>
			<p>
				<strong>Trạng thái:</strong> <span
					th:class="'badge badge-' + ${shipment.status}"
					th:text="${shipment.status}"></span>
			</p>
			<p th:if="${shipment.pickupTime}">
				<strong>Thời gian lấy:</strong> <span
					th:text="${#temporals.format(shipment.pickupTime, 'dd/MM/yyyy HH:mm')}"></span>
			</p>
			<p th:if="${shipment.deliveryTime}">
				<strong>Thời gian giao:</strong> <span
					th:text="${#temporals.format(shipment.deliveryTime, 'dd/MM/yyyy HH:mm')}"></span>
			</p>
			<p th:if="${shipment.notes}">
				<strong>Ghi chú:</strong> <span th:text="${shipment.notes}"></span>
			</p>
		</div>
	</div>
	<script>
        function openMap() {
            const address = "[[${order.recipientAddress}]]";
            window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(address)}`, '_blank');
        }
    </script>
</body>
</html>