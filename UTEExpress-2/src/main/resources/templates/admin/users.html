<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Quản lý Users - UTEExpress</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
	<style>
		:root {
			--primary-color: #2c3e50;
			--secondary-color: #3498db;
			--sidebar-width: 260px;
		}

		body {
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			background: #ecf0f1;
		}

		.sidebar {
			position: fixed;
			top: 0;
			left: 0;
			height: 100vh;
			width: var(--sidebar-width);
			background: linear-gradient(135deg, var(--primary-color) 0%, #34495e 100%);
			box-shadow: 4px 0 10px rgba(0, 0, 0, 0.1);
			z-index: 1000;
			overflow-y: auto;
		}

		.sidebar .logo {
			padding: 25px 20px;
			border-bottom: 1px solid rgba(255, 255, 255, 0.1);
			text-align: center;
		}

		.sidebar .logo h3 {
			color: white;
			margin: 0;
			font-size: 24px;
			font-weight: 700;
		}

		.sidebar-nav {
			padding: 20px 0;
		}

		.nav-item {
			margin: 5px 15px;
		}

		.nav-link {
			color: rgba(255, 255, 255, 0.8);
			padding: 12px 20px;
			border-radius: 8px;
			display: flex;
			align-items: center;
			transition: all 0.3s;
			text-decoration: none;
		}

		.nav-link:hover,
		.nav-link.active {
			background: rgba(255, 255, 255, 0.1);
			color: white;
		}

		.nav-link i {
			width: 20px;
			margin-right: 12px;
		}

		.main-content {
			margin-left: var(--sidebar-width);
			padding: 0;
		}

		.topbar {
			background: white;
			padding: 15px 30px;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
			position: sticky;
			top: 0;
			z-index: 999;
		}

		.content-area {
			padding: 30px;
		}

		.page-header {
			background: white;
			border-radius: 15px;
			padding: 25px;
			margin-bottom: 25px;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
		}

		.page-title {
			font-size: 28px;
			font-weight: 700;
			color: var(--primary-color);
			margin: 0;
		}

		.filter-section {
			background: white;
			border-radius: 15px;
			padding: 20px;
			margin-bottom: 25px;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
		}

		.table-container {
			background: white;
			border-radius: 15px;
			padding: 25px;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
		}

		.table {
			margin-bottom: 0;
		}

		.table thead {
			background: #f8f9fa;
		}

		.table th {
			font-weight: 600;
			color: var(--primary-color);
			border-bottom: 2px solid #dee2e6;
		}

		.badge {
			padding: 6px 12px;
			border-radius: 6px;
			font-weight: 500;
		}

		.btn-action {
			width: 32px;
			height: 32px;
			padding: 0;
			border-radius: 6px;
			display: inline-flex;
			align-items: center;
			justify-content: center;
			margin: 0 2px;
		}

		.alert {
			border-radius: 10px;
			border: none;
		}
	</style>
</head>

<body>
	<div class="sidebar">
		<div class="logo">
			<div class="logo-icon">
				<i class="fas fa-shipping-fast"></i>
			</div>
			<h3>UTEExpress</h3>
			<span>Admin Panel</span>
		</div>

		<nav class="sidebar-nav">
			<div class="nav-item">
				<a href="/admin/dashboard" class="nav-link active">
					<i class="fas fa-home"></i>
					<span>Dashboard</span>
				</a>
			</div>

			<div class="nav-item">
				<a href="/admin/users" class="nav-link">
					<i class="fas fa-users"></i>
					<span>Quản lý User</span>
				</a>
			</div>

			<div class="nav-item">
				<a href="/admin/orders" class="nav-link">
					<i class="fas fa-box"></i>
					<span>Đơn hàng</span>
				</a>
			</div>

			<div class="nav-item">
				<a href="/admin/warehouses" class="nav-link">
					<i class="fas fa-warehouse"></i>
					<span>Kho hàng</span>
				</a>
			</div>

			<div class="nav-item">
				<a href="/admin/chat" class="nav-link">
					<i class="fas fa-comments"></i>
					<span>Chat</span>
					<span class="badge-notif">3</span>
				</a>
			</div>

			<div class="nav-item">
				<a href="/admin/notifications" class="nav-link">
					<i class="fas fa-bell"></i>
					<span>Thông báo</span>
					<span class="badge-notif">6</span>
				</a>
			</div>

			<div class="nav-item">
				<a href="/admin/reports" class="nav-link">
					<i class="fas fa-chart-bar"></i>
					<span>Báo cáo</span>
				</a>
			</div>

			<div class="nav-item">
				<a href="/logout" class="nav-link">
					<i class="fas fa-sign-out-alt"></i>
					<span>Đăng xuất</span>
				</a>
			</div>
		</nav>
	</div>

	<!-- Main Content -->
	<div class="main-content">
		<div class="topbar">
			<h4 class="mb-0">Quản lý Users</h4>
		</div>

		<div class="content-area">
			<!-- Alert Messages -->
			<div th:if="${success}" class="alert alert-success alert-dismissible fade show">
				<i class="fas fa-check-circle me-2"></i> <span th:text="${success}"></span>
				<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
			</div>

			<div th:if="${error}" class="alert alert-danger alert-dismissible fade show">
				<i class="fas fa-exclamation-circle me-2"></i> <span th:text="${error}"></span>
				<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
			</div>

			<!-- Page Header -->
			<div class="page-header d-flex justify-content-between align-items-center">
				<h2 class="page-title">Danh sách Users</h2>
				<a href="/admin/users/create" class="btn btn-primary"> <i class="fas fa-plus me-2"></i>Tạo User Mới
				</a>
			</div>

			<!-- Filter Section -->
			<div class="filter-section">
				<form method="get" action="/admin/users">
					<div class="row g-3">
						<div class="col-md-3">
							<select name="role" class="form-select">
								<option value="">Tất cả vai trò</option>
								<option value="ROLE_ADMIN">Admin</option>
								<option value="ROLE_CUSTOMER">Customer</option>
								<option value="ROLE_SHIPPER">Shipper</option>
								<option value="ROLE_WAREHOUSE_STAFF">Warehouse Staff</option>
								<option value="ROLE_SUPPORT">Support</option>
							</select>
						</div>
						<div class="col-md-3">
							<select name="status" class="form-select">
								<option value="">Tất cả trạng thái</option>
								<option value="true">Đang hoạt động</option>
								<option value="false">Không hoạt động</option>
							</select>
						</div>
						<div class="col-md-4">
							<input type="text" name="search" class="form-control" placeholder="Tìm kiếm user...">
						</div>
						<div class="col-md-2">
							<button type="submit" class="btn btn-primary w-100">
								<i class="fas fa-search me-2"></i>Tìm kiếm
							</button>
						</div>
					</div>
				</form>
			</div>

			<!-- Users Table -->
			<div class="table-container">
				<div class="table-responsive">
					<table class="table table-hover align-middle">
						<thead>
							<tr>
								<th>ID</th>
								<th>Username</th>
								<th>Họ tên</th>
								<th>Email</th>
								<th>Vai trò</th>
								<th>Trạng thái</th>
								<th>Thao tác</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="user : ${users}">
								<td th:text="${user.id}"></td>
								<td><strong th:text="${user.username}"></strong></td>
								<td th:text="${user.fullName}"></td>
								<td th:text="${user.email}"></td>
								<td><span th:each="role : ${user.roles}" th:text="${role.name}"
										class="badge bg-info me-1"></span></td>
								<td><span th:if="${user.isActive}" class="badge bg-success">
										<i class="fas fa-check me-1"></i>Hoạt động
									</span> <span th:unless="${user.isActive}" class="badge bg-danger">
										<i class="fas fa-times me-1"></i>Không hoạt động
									</span></td>
								<td><a th:href="@{/admin/users/{id}(id=${user.id})}"
										class="btn btn-sm btn-info btn-action" title="Xem chi tiết">
										<i class="fas fa-eye"></i>
									</a> <a th:href="@{/admin/users/{id}/edit(id=${user.id})}"
										class="btn btn-sm btn-warning btn-action" title="Sửa"> <i
											class="fas fa-edit"></i>
									</a>
									<form th:action="@{/admin/users/{id}/toggle-status(id=${user.id})}" method="post"
										style="display: inline;">
										<button type="submit" class="btn btn-sm btn-action"
											th:classappend="${user.isActive} ? 'btn-secondary' : 'btn-success'"
											th:title="${user.isActive} ? 'Vô hiệu hóa' : 'Kích hoạt'">
											<i th:class="${user.isActive} ? 'fas fa-ban' : 'fas fa-check'"></i>
										</button>
									</form>
									<form th:action="@{/admin/users/{id}/delete(id=${user.id})}" method="post"
										style="display: inline;"
										onsubmit="return confirm('Bạn có chắc muốn xóa user này?');">
										<button type="submit" class="btn btn-sm btn-danger btn-action" title="Xóa">
											<i class="fas fa-trash"></i>
										</button>
									</form>
								</td>
							</tr>
							<tr th:if="${#lists.isEmpty(users)}">
								<td colspan="7" class="text-center py-4"><i
										class="fas fa-inbox fa-3x text-muted mb-3 d-block"></i>
									<p class="text-muted mb-0">Không tìm thấy user nào</p>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>