<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Hồ sơ cá nhân</title>
<link rel="stylesheet" th:href="@{/css/shipper.css}">
</head>
<body>
	<div th:replace="~{fragments/shipper-header :: header}"></div>
	<div class="container">
		<h1>Hồ sơ cá nhân</h1>

		<div class="profile-grid">
			<div class="profile-card">
				<h3>Thông tin cá nhân</h3>
				<p>
					<strong>Mã Shipper:</strong> <span th:text="${shipper.code}"></span>
				</p>
				<p>
					<strong>Tên:</strong> <span th:text="${shipper.name}"></span>
				</p>
				<p>
					<strong>Email:</strong> <span th:text="${shipper.email}"></span>
				</p>
				<p>
					<strong>Số điện thoại:</strong> <span th:text="${shipper.phone}"></span>
				</p>
				<p>
					<strong>Trạng thái:</strong> <span
						th:class="${shipper.isActive ? 'badge badge-success' : 'badge badge-danger'}"
						th:text="${shipper.isActive ? 'Hoạt động' : 'Không hoạt động'}"></span>
				</p>
			</div>

			<div class="profile-card">
				<h3>Phương tiện</h3>
				<p>
					<strong>Loại xe:</strong> <span th:text="${shipper.vehicleType}"></span>
				</p>
				<p>
					<strong>Biển số:</strong> <span th:text="${shipper.vehicleNumber}"></span>
				</p>
			</div>

			<div class="profile-card">
				<h3>Thống kê</h3>
				<p>
					<strong>Tổng giao hàng:</strong> <span
						th:text="${shipper.totalDeliveries}"></span>
				</p>
				<p>
					<strong>Thành công:</strong> <span class="text-success"
						th:text="${shipper.successfulDeliveries}"></span>
				</p>
				<p>
					<strong>Thất bại:</strong> <span class="text-danger"
						th:text="${shipper.failedDeliveries}"></span>
				</p>
				<p>
					<strong>Tỷ lệ thành công:</strong> <span
						th:text="${shipper.totalDeliveries > 0 ? 
                        #numbers.formatDecimal((shipper.successfulDeliveries * 100.0 / shipper.totalDeliveries), 1, 2) + '%' : 
                        '0%'}"></span>
				</p>
			</div>
		</div>

		<div class="section">
			<h3>Vị trí hiện tại</h3>
			<div id="map-container">
				<button onclick="getCurrentLocation()" class="btn-primary">Lấy
					vị trí hiện tại</button>
				<div id="location-info" class="mt-3"></div>
			</div>
		</div>
	</div>
	<script>
        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    document.getElementById('location-info').innerHTML = `
                        <p><strong>Vĩ độ:</strong> ${position.coords.latitude}</p>
                        <p><strong>Kinh độ:</strong> ${position.coords.longitude}</p>
                        <p><strong>Độ chính xác:</strong> ${position.coords.accuracy} mét</p>
                    `;
                }, function(error) {
                    document.getElementById('location-info').innerHTML = 
                        '<p class="text-danger">Không thể lấy vị trí: ' + error.message + '</p>';
                });
            } else {
                alert('Trình duyệt không hỗ trợ định vị');
            }
        }
    </script>
</body>
</html>